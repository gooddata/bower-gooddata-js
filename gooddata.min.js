/* Copyright (C) 2007-2013, GoodData(R) Corporation. All rights reserved. */
/* gooddata - v0.1.19 */
/* 2015-07-27 15:05:07 */
/* Latest git commit: "9b36b89" */


!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?exports.gooddata=e(require("jquery")):t.gooddata=e(t.jQuery)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var n,i;n=[r(1),r(4),r(5),r(6),r(7),r(8),r(3)],i=function(t,e,r,n,i,o,a){"use strict";return{config:a,xhr:t,user:r,md:n,execution:i,project:o}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(2),r(3)],i=function(t,e){"use strict";var r,n,i={};i.enrichSettingWithCustomDomain=function(t,e){return e&&(-1===t.url.indexOf(e)&&(t.url=e+t.url),t.xhrFields=t.xhrFields||{},t.xhrFields.withCredentials=!0),t};var o=function(t,e){i.ajax(t).done(function(t,r,n){e.resolve(t,r,n)}).fail(function(t,r,n){e.reject(t,r,n)})},a=function(t,e){r.done(function(){o(t,e)}).fail(function(t,r,n){401!==t.status&&e.reject(t,r,n)})},c=function(n,o){r||(r=t.ajax(i.enrichSettingWithCustomDomain({url:"/gdc/account/token/"},e.domain)).always(function(){r=null}).fail(function(e,r,i){return 401===e.status&&t.isFunction(n.unauthorized)?void n.unauthorized(e,r,i,o):void o.reject(e,r,i)})),a(n,o)},u=function(t,e){setTimeout(function(){o(t,e)},t.pollDelay)},s=function(e,r,n){var i=e[r];delete e[r],t.isFunction(i)&&n(i),t.isArray(i)&&i.forEach(function(e){t.isFunction(i)&&n(e)})};i.ajaxSetup=function(e){n=t.extend({contentType:"application/json",dataType:"json",pollDelay:1e3,headers:{Accept:"application/json; charset=utf-8"}},e)},i.ajax=function(o,f){t.isPlainObject(o)&&(f=o,o=void 0),f=t.extend({},n,f),o&&(f.url=o),t.isPlainObject(f.data)&&(f.data=JSON.stringify(f.data));var l=t.Deferred();return s(f,"success",l.done),s(f,"error",l.fail),s(f,"complete",l.always),r?(a(f,l),l):(t.ajax(i.enrichSettingWithCustomDomain(f,e.domain)).fail(function(t,e,r){401===t.status?c(f,l):l.reject(t,e,r)}).done(function(t,e,r){if(202===r.status){var n=r.getResponseHeader("Location");n&&(f.url=n),f.method="GET",u(f,l)}else l.resolve(t,e,r)}),l)};var f=function(e){return function(r,n){var o=t.extend(!0,{method:e},n);return i.ajax(r,o)}};return i.get=f("GET"),i.post=f("POST"),i.put=f("PUT"),i.ajaxSetup({}),i}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(e,r,n){e.exports=t},function(t,e,r){var n,i;n=[],i=function(){"use strict";var t={domain:void 0},e="(?:(https)://+|(www\\.)?)\\w[:;,\\.?\\[\\]\\w/~%&=+#-@!]*",r=function(r){var n=r.match(e);if(!n)throw new Error(r+" is not a valid url");t.domain="https://"+n[0].replace(/^https:\/\//,"").replace(/\/$/,"")};return t.setCustomDomain=r,t}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n;n=function(){"use strict";var t=function(t,e){var r,n=e.split("."),i=t;for(r=0;r<n.length;++r){if(void 0===i[n[r]])return void 0;i=i[n[r]]}return i},e=function(e){return function(r){return t(r,e)}};return{getPath:t,getIn:e}}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,r){var n,i;n=[r(2),r(1)],i=function(t,e){"use strict";var r=function(){return t.getJSON("/gdc/account/token")},n=function(t,r){return e.post("/gdc/account/login",{data:JSON.stringify({postUserLogin:{login:t,password:r,remember:1,captcha:"",verifyCaptcha:""}})})},i=function(){var n=t.Deferred();return r().then(function(){return e.get("/gdc/app/account/bootstrap").then(function(t){var e=t.bootstrapResource.accountSetting.links.self,r=e.match(/([^\/]+)\/?$/)[1];return r},n.reject)},n.resolve).then(function(t){return e.ajax("/gdc/account/login/"+t,{method:"delete"})}).then(n.resolve,n.reject),n.promise()},o=function(){var r=t.Deferred();return e.get("/gdc/app/account/bootstrap").then(function(t){var e=t.bootstrapResource,n={login:e.accountSetting.login,loginMD5:e.current.loginMD5,firstName:e.accountSetting.firstName,lastName:e.accountSetting.lastName,organizationName:e.settings.organizationName,profileUri:e.accountSetting.links.self};r.resolve(n)},r.reject),r.promise()};return{isLoggedIn:r,login:n,logout:i,getAccountInfo:o}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(2),r(1),r(4)],i=function(t,e,r){"use strict";var n=function(t){return e.get("/gdc/md/"+t+"/query/attributes").then(r.getIn("query.entries"))},i=function(t){return e.get("/gdc/md/"+t+"/query/dimensions").then(r.getIn("query.entries"))},o=function(n,o){var a=function(t,n){var i=n?"?type="+n:"";return e.get("/gdc/md/"+t+"/query/folders"+i).then(r.getIn("query.entries"))};switch(o){case"fact":case"metric":return a(n,o);case"attribute":return i(n);default:var c=t.Deferred();return t.when(a(n,"fact"),a(n,"metric"),i(n)).done(function(t,e,r){c.resolve({fact:t,metric:e,attribute:r})}),c.promise()}},a=function(e,r){var i=t.Deferred();return o(e,r).then(function(o){var a=function(e){var r=t.Deferred();return t.when.apply(this,e.map(p)).then(function(){var t=Array.prototype.slice.call(arguments).map(function(t){return t.metric});r.resolve(t)},r.reject),r.promise()},c=function(t,e){return t.map(function(t){return t[e]})},s=function(t){t.forEach(function(t){t.items.sort(function(t,e){return t.meta.title<e.meta.title?-1:t.meta.title>e.meta.title?1:0})}),t.sort(function(t,e){return t.title<e.title?-1:t.title>e.title?1:0})},f=c(o,"link"),l=c(o,"title");t.when.apply(this,f.map(p)).then(function(){var o=Array.prototype.slice.call(arguments);if("attribute"===r)n(e).then(function(e){var r=[];o.forEach(function(t){t.dimension.content.attributes.forEach(function(t){r.push(t.meta.uri)})});var n=e.filter(function(t){return-1===r.indexOf(t.link)}).map(function(t){return t.link});t.when.apply(this,n.map(p)).then(function(){var t=Array.prototype.slice.call(arguments).map(function(t){return t.attribute}),e=o.map(function(t){return{title:t.dimension.meta.title,items:t.dimension.content.attributes}});e.push({title:"Unsorted",items:t}),s(e),i.resolve(e)})});else if("metric"===r){var f=o.map(function(t){return c(t.folder.content.entries,"link")});u(e).then(function(e){var r=[];o.forEach(function(t){t.folder.content.entries.forEach(function(t){r.push(t.link)})});var n=e.filter(function(t){return-1===r.indexOf(t.link)}).map(function(t){return t.link});f.push(n),t.when.apply(this,f.map(function(t,e){return a(t)})).then(function(){var t=Array.prototype.slice.call(arguments),e=t.map(function(t,e){return{title:l[e]||"Unsorted",items:t}});s(e),i.resolve(e)},i.reject)})}else i.reject()})},i.reject),i.promise()},c=function(t){return e.get("/gdc/md/"+t+"/query/facts").then(r.getIn("query.entries"))},u=function(t){return e.get("/gdc/md/"+t+"/query/metrics").then(r.getIn("query.entries"))},s=function(r,n){var i=t.Deferred();return e.post("/gdc/md/"+r+"/availablemetrics",{data:JSON.stringify(n)}).then(function(t){i.resolve(t.entries)},i.reject),i.promise()},f=function(r,n){var i=t.Deferred();return e.post("/gdc/md/"+r+"/drillcrosspaths",{data:JSON.stringify(n)}).then(function(t){i.resolve(t.drillcrosspath.links)},i.reject),i.promise()},l=function(r,n){var i=t.Deferred();return e.post("/gdc/md/"+r+"/availablefacts",{data:JSON.stringify(n)}).then(function(t){i.resolve(t.entries)},i.reject),i.promise()},p=function(r){var n=t.Deferred();return e.get(r,{headers:{Accept:"application/json"},dataType:"json",contentType:"application/json"}).then(function(t){n.resolve(t)},n.reject),n.promise()},d=function(e){var r,n=t.Deferred(),i=function(t){if(t.attribute)return t.attribute.content.displayForms[0].meta.identifier;if(t.dimension)return t.dimension.content.attributes.content.displayForms[0].meta.identifier;if(t.metric)return t.metric.meta.identifier;throw"Unknown object!"};return t.isPlainObject(e)?n.resolve(i(r)):p(e).then(function(t){n.resolve(i(t))},n.reject),n.promise()},m=function(r,n){var i=t.Deferred(),o=function(t){var e=t.attribute?t.attribute:t.metric;return e.meta.uri};return e.ajax("/gdc/md/"+r+"/identifiers",{type:"POST",headers:{Accept:"application/json"},data:{identifierToUri:[n]}}).then(function(e){var r=e.identifiers.filter(function(t){return t.identifier===n});return r[0]?p(r[0].uri):t.Deferred().reject("identifier not found")},i.reject).then(function(t){return t.attributeDisplayForm?p(t.attributeDisplayForm.content.formOf).then(function(t){i.resolve(o(t))},i.reject):i.resolve(o(t))},i.reject),i.promise()};return{getAttributes:n,getDimensions:i,getFolders:o,getFoldersWithItems:a,getFacts:c,getMetrics:u,getAvailableMetrics:s,getAvailableAttributes:f,getAvailableFacts:l,getObjectDetails:p,getObjectIdentifier:d,getObjectUri:m}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(2),r(1)],i=function(t,e){"use strict";var r=function(r,n,i){var o={execution:{columns:n}};i=i||{},["filters","where","orderBy","definitions"].forEach(function(t){i[t]&&(o.execution[t]=i[t])});var a={isLoaded:!1},c=t.Deferred();return e.post("/gdc/internal/projects/"+r+"/experimental/executions",{data:JSON.stringify(o)},c.reject).then(function(t){return a.headers=t.executionResult.columns.map(function(t){return t.attributeDisplayForm?{type:"attrLabel",id:t.attributeDisplayForm.meta.identifier,uri:t.attributeDisplayForm.meta.uri,title:t.attributeDisplayForm.meta.title}:{type:"metric",id:t.metric.meta.identifier,uri:t.metric.meta.uri,title:t.metric.meta.title,format:t.metric.content.format}}),e.ajax(t.executionResult.tabularDataResult)},c.reject).then(function(t){a.rawData=t&&t.tabularDataResult?t.tabularDataResult.values:[],a.isLoaded=!0,c.resolve(a)},c.reject),c.promise()};return{getData:r}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(2),r(1),r(4)],i=function(t,e,r){"use strict";var n=function(){return e.get("/gdc/app/account/bootstrap").then(function(t){var e=t.bootstrapResource.current.project;return e?t.bootstrapResource.current.project.links.self.split("/").pop():null})},i=function(t){return e.get("/gdc/account/profile/"+t+"/projects").then(function(t){return t.projects.map(function(t){return t.project})})},o=function(t){return e.get("/gdc/md/"+t+"/query/datasets").then(r.getIn("query.entries"))},a=[{r:43,g:107,b:174},{r:105,g:170,b:81},{r:238,g:177,b:76},{r:213,g:60,b:56},{r:137,g:77,b:148},{r:115,g:115,b:115},{r:68,g:169,b:190},{r:150,g:189,b:95},{r:253,g:147,b:105},{r:225,g:93,b:134},{r:124,g:111,b:173},{r:165,g:165,b:165},{r:122,g:166,b:213},{r:130,g:208,b:141},{r:255,g:210,b:137},{r:241,g:132,b:128},{r:191,g:144,b:198},{r:191,g:191,b:191}],c=function(r){var n=t.Deferred();return e.get("/gdc/projects/"+r+"/styleSettings").then(function(t){n.resolve(t.styleSettings.chartPalette.map(function(t){return{r:t.fill.r,g:t.fill.g,b:t.fill.b}}))},function(t){200===t.status&&n.resolve(a),n.reject(t)}),n.promise()},u=function(r,n){var i=t.Deferred();return e.put("/gdc/projects/"+r+"/styleSettings",{data:{styleSettings:{chartPalette:n.map(function(t,e){return{guid:"guid"+e,fill:t}})}}}).then(i.resolve,i.reject),i.promise()},s=function(r){var n=t.Deferred(),i="/gdc/app/account/bootstrap?projectId="+r;return e.get(i).then(function(t){var e=t.bootstrapResource.current.timezone;n.resolve(e)},n.reject),n.promise()},f=function(r,n){var i=t.Deferred(),o="/gdc/md/"+r+"/service/timezone",a={service:{timezone:n}};return e.ajax(o,{type:"POST",headers:{Accept:"application/json"},data:a}).then(i.resolve,i.reject),i.promise()};return{getCurrentProjectId:n,getProjects:i,getDatasets:o,getColorPalette:c,setColorPalette:u,getTimezone:s,setTimezone:f,DEFAULT_PALETTE:a}}.apply(e,n),!(void 0!==i&&(t.exports=i))}])});