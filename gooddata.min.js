/* Copyright (C) 2007-2013, GoodData(R) Corporation. All rights reserved. */
/* gooddata - v0.1.14 */
/* 2015-05-22 15:31:48 */
/* Latest git commit: "8427373" */


!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.gooddata=e(require("jQuery")):t.gooddata=e(t.jQuery)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var n,i;n=[r(1),r(4),r(5),r(6),r(7),r(8),r(3)],i=function(t,e,r,n,i,o,a){"use strict";return{config:a,xhr:t,user:r,md:n,execution:i,project:o}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(2),r(3)],i=function(t,e){"use strict";var r,n,i={};i.enrichSettingWithCustomDomain=function(t,e){return e&&(-1===t.url.indexOf(e)&&(t.url=e+t.url),t.xhrFields=t.xhrFields||{},t.xhrFields.withCredentials=!0),t};var o=function(t,e){i.ajax(t).done(function(t,r,n){e.resolve(t,r,n)}).fail(function(t,r,n){e.reject(t,r,n)})},a=function(t,e){r.done(function(){o(t,e)}).fail(function(t,r,n){401!==t.status&&e.reject(t,r,n)})},c=function(n,o){r||(r=t.ajax(i.enrichSettingWithCustomDomain({url:"/gdc/account/token/"},e.domain)).always(function(){r=null}).fail(function(e,r,i){return 401===e.status&&t.isFunction(n.unauthorized)?void n.unauthorized(e,r,i,o):void o.reject(e,r,i)})),a(n,o)},u=function(t,e){setTimeout(function(){o(t,e)},t.pollDelay)},s=function(e,r,n){var i=e[r];delete e[r],t.isFunction(i)&&n(i),t.isArray(i)&&i.forEach(function(e){t.isFunction(i)&&n(e)})};i.ajaxSetup=function(e){n=t.extend({contentType:"application/json",dataType:"json",pollDelay:1e3,headers:{Accept:"application/json; charset=utf-8"}},e)},i.ajax=function(o,f){t.isPlainObject(o)&&(f=o,o=void 0),f=t.extend({},n,f),o&&(f.url=o),t.isPlainObject(f.data)&&(f.data=JSON.stringify(f.data));var l=t.Deferred();return s(f,"success",l.done),s(f,"error",l.fail),s(f,"complete",l.always),r?(a(f,l),l):(t.ajax(i.enrichSettingWithCustomDomain(f,e.domain)).fail(function(t,e,r){401===t.status?c(f,l):l.reject(t,e,r)}).done(function(t,e,r){if(202===r.status){var n=r.getResponseHeader("Location");n&&(f.url=n),u(f,l)}else l.resolve(t,e,r)}),l)};var f=function(e){return function(r,n){var o=t.extend(!0,{method:e},n);return i.ajax(r,o)}};return i.get=f("GET"),i.post=f("POST"),i.put=f("PUT"),i.ajaxSetup({}),i}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(e,r,n){e.exports=t},function(t,e,r){var n,i;n=[],i=function(){"use strict";var t={domain:void 0},e="(?:(https)://+|(www\\.)?)\\w[:;,\\.?\\[\\]\\w/~%&=+#-@!]*",r=function(r){var n=r.match(e);if(!n)throw new Error(r+" is not a valid url");t.domain="https://"+n[0].replace(/^https:\/\//,"").replace(/\/$/,"")};return t.setCustomDomain=r,t}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n;n=function(){"use strict";var t=function(t,e){var r,n=e.split("."),i=t;for(r=0;r<n.length;++r){if(void 0===i[n[r]])return void 0;i=i[n[r]]}return i},e=function(e){return function(r){return t(r,e)}};return{getPath:t,getIn:e}}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,r){var n,i;n=[r(1)],i=function(t){"use strict";var e=function(){return $.getJSON("/gdc/account/token")},r=function(e,r){return t.post("/gdc/account/login",{data:JSON.stringify({postUserLogin:{login:e,password:r,remember:1,captcha:"",verifyCaptcha:""}})})},n=function(){var r=$.Deferred();return e().then(function(){return t.get("/gdc/app/account/bootstrap").then(function(t){var e=t.bootstrapResource.accountSetting.links.self,r=e.match(/([^\/]+)\/?$/)[1];return r},r.reject)},r.resolve).then(function(e){return t.ajax("/gdc/account/login/"+e,{method:"delete"})}).then(r.resolve,r.reject),r.promise()},i=function(){var e=$.Deferred();return t.get("/gdc/app/account/bootstrap").then(function(t){var r=t.bootstrapResource,n={login:r.accountSetting.login,loginMD5:r.current.loginMD5,firstName:r.accountSetting.firstName,lastName:r.accountSetting.lastName,organizationName:r.settings.organizationName};e.resolve(n)},e.reject),e.promise()};return{isLoggedIn:e,login:r,logout:n,getAccountInfo:i}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(1),r(4)],i=function(t,e){"use strict";var r=function(r){return t.get("/gdc/md/"+r+"/query/attributes").then(e.getIn("query.entries"))},n=function(r){return t.get("/gdc/md/"+r+"/query/dimensions").then(e.getIn("query.entries"))},i=function(r,i){var o=function(r,n){var i=n?"?type="+n:"";return t.get("/gdc/md/"+r+"/query/folders"+i).then(e.getIn("query.entries"))};switch(i){case"fact":case"metric":return o(r,i);case"attribute":return n(r);default:var a=$.Deferred();return $.when(o(r,"fact"),o(r,"metric"),n(r)).done(function(t,e,r){a.resolve({fact:t,metric:e,attribute:r})}),a.promise()}},o=function(t,e){var n=$.Deferred();return i(t,e).then(function(i){var o=function(t){var e=$.Deferred();return $.when.apply(this,t.map(l)).then(function(){var t=Array.prototype.slice.call(arguments).map(function(t){return t.metric});e.resolve(t)},e.reject),e.promise()},a=function(t,e){return t.map(function(t){return t[e]})},u=function(t){t.forEach(function(t){t.items.sort(function(t,e){return t.meta.title<e.meta.title?-1:t.meta.title>e.meta.title?1:0})}),t.sort(function(t,e){return t.title<e.title?-1:t.title>e.title?1:0})},s=a(i,"link"),f=a(i,"title");$.when.apply(this,s.map(l)).then(function(){var i=Array.prototype.slice.call(arguments);if("attribute"===e)r(t).then(function(t){var e=[];i.forEach(function(t){t.dimension.content.attributes.forEach(function(t){e.push(t.meta.uri)})});var r=t.filter(function(t){return-1===e.indexOf(t.link)}).map(function(t){return t.link});$.when.apply(this,r.map(l)).then(function(){var t=Array.prototype.slice.call(arguments).map(function(t){return t.attribute}),e=i.map(function(t){return{title:t.dimension.meta.title,items:t.dimension.content.attributes}});e.push({title:"Unsorted",items:t}),u(e),n.resolve(e)})});else if("metric"===e){var s=i.map(function(t){return a(t.folder.content.entries,"link")});c(t).then(function(t){var e=[];i.forEach(function(t){t.folder.content.entries.forEach(function(t){e.push(t.link)})});var r=t.filter(function(t){return-1===e.indexOf(t.link)}).map(function(t){return t.link});s.push(r),$.when.apply(this,s.map(function(t,e){return o(t)})).then(function(){var t=Array.prototype.slice.call(arguments),e=t.map(function(t,e){return{title:f[e]||"Unsorted",items:t}});u(e),n.resolve(e)},n.reject)})}else n.reject()})},n.reject),n.promise()},a=function(r){return t.get("/gdc/md/"+r+"/query/facts").then(e.getIn("query.entries"))},c=function(r){return t.get("/gdc/md/"+r+"/query/metrics").then(e.getIn("query.entries"))},u=function(e,r){var n=$.Deferred();return t.post("/gdc/md/"+e+"/availablemetrics",{data:JSON.stringify(r)}).then(function(t){n.resolve(t.entries)},n.reject),n.promise()},s=function(e,r){var n=$.Deferred();return t.post("/gdc/md/"+e+"/drillcrosspaths",{data:JSON.stringify(r)}).then(function(t){n.resolve(t.drillcrosspath.links)},n.reject),n.promise()},f=function(e,r){var n=$.Deferred();return t.post("/gdc/md/"+e+"/availablefacts",{data:JSON.stringify(r)}).then(function(t){n.resolve(t.entries)},n.reject),n.promise()},l=function(e){var r=$.Deferred();return t.get(e,{headers:{Accept:"application/json"},dataType:"json",contentType:"application/json"}).then(function(t){r.resolve(t)},r.reject),r.promise()},p=function(t){var e,r=$.Deferred(),n=function(t){if(t.attribute)return t.attribute.content.displayForms[0].meta.identifier;if(t.dimension)return t.dimension.content.attributes.content.displayForms[0].meta.identifier;if(t.metric)return t.metric.meta.identifier;throw"Unknown object!"};return $.isPlainObject(t)?r.resolve(n(e)):l(t).then(function(t){r.resolve(n(t))},r.reject),r.promise()},d=function(e,r){var n=$.Deferred(),i=function(t){var e=t.attribute?t.attribute:t.metric;return e.meta.uri};return t.ajax("/gdc/md/"+e+"/identifiers",{type:"POST",headers:{Accept:"application/json"},data:{identifierToUri:[r]}}).then(function(t){var e=t.identifiers.filter(function(t){return t.identifier===r});return e[0]?l(e[0].uri):$.Deferred().reject("identifier not found")},n.reject).then(function(t){return t.attributeDisplayForm?l(t.attributeDisplayForm.content.formOf).then(function(t){n.resolve(i(t))},n.reject):n.resolve(i(t))},n.reject),n.promise()};return{getAttributes:r,getDimensions:n,getFolders:i,getFoldersWithItems:o,getFacts:a,getMetrics:c,getAvailableMetrics:u,getAvailableAttributes:s,getAvailableFacts:f,getObjectDetails:l,getObjectIdentifier:p,getObjectUri:d}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(1)],i=function(t){"use strict";var e=function(e,r,n){var i={execution:{columns:r}};n=n||{},["filters","where","orderBy","definitions"].forEach(function(t){n[t]&&(i.execution[t]=n[t])});var o={isLoaded:!1},a=$.Deferred();return t.post("/gdc/internal/projects/"+e+"/experimental/executions",{data:JSON.stringify(i)},a.reject).then(function(e){return o.headers=e.executionResult.columns.map(function(t){return t.attributeDisplayForm?{type:"attrLabel",id:t.attributeDisplayForm.meta.identifier,uri:t.attributeDisplayForm.meta.uri,title:t.attributeDisplayForm.meta.title}:{type:"metric",id:t.metric.meta.identifier,title:t.metric.meta.title,format:t.metric.content.format}}),t.ajax(e.executionResult.tabularDataResult)},a.reject).then(function(t){o.rawData=t&&t.tabularDataResult?t.tabularDataResult.values:[],o.isLoaded=!0,a.resolve(o)},a.reject),a.promise()};return{getData:e}}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(1),r(4)],i=function(t,e){"use strict";var r=function(){return t.get("/gdc/app/account/bootstrap").then(function(t){var e=t.bootstrapResource.current.project;return e?t.bootstrapResource.current.project.links.self.split("/").pop():null})},n=function(e){return t.get("/gdc/account/profile/"+e+"/projects").then(function(t){return t.projects.map(function(t){return t.project})})},i=function(r){return t.get("/gdc/md/"+r+"/query/datasets").then(e.getIn("query.entries"))},o=[{r:43,g:107,b:174},{r:105,g:170,b:81},{r:238,g:177,b:76},{r:213,g:60,b:56},{r:137,g:77,b:148},{r:115,g:115,b:115},{r:68,g:169,b:190},{r:150,g:189,b:95},{r:253,g:147,b:105},{r:225,g:93,b:134},{r:124,g:111,b:173},{r:165,g:165,b:165},{r:122,g:166,b:213},{r:130,g:208,b:141},{r:255,g:210,b:137},{r:241,g:132,b:128},{r:191,g:144,b:198},{r:191,g:191,b:191}],a=function(e){var r=$.Deferred();return t.get("/gdc/projects/"+e+"/styleSettings").then(function(t){r.resolve(t.styleSettings.chartPalette.map(function(t){return{r:t.fill.r,g:t.fill.g,b:t.fill.b}}))},function(t){200===t.status&&r.resolve(o),r.reject(t)}),r.promise()},c=function(e,r){var n=$.Deferred();return t.put("/gdc/projects/"+e+"/styleSettings",{data:{styleSettings:{chartPalette:r.map(function(t,e){return{guid:"guid"+e,fill:t}})}}}).then(n.resolve,n.reject),n.promise()},u=function(e){var r=$.Deferred(),n="/gdc/app/account/bootstrap?projectId="+e;return t.get(n).then(function(t){var e=t.bootstrapResource.current.timezone;r.resolve(e)},r.reject),r.promise()},s=function(e,r){var n=$.Deferred(),i="/gdc/md/"+e+"/service/timezone",o={service:{timezone:r}};return t.ajax(i,{type:"POST",headers:{Accept:"application/json"},data:o}).then(n.resolve,n.reject),n.promise()};return{getCurrentProjectId:r,getProjects:n,getDatasets:i,getColorPalette:a,setColorPalette:c,getTimezone:u,setTimezone:s,DEFAULT_PALETTE:o}}.apply(e,n),!(void 0!==i&&(t.exports=i))}])});